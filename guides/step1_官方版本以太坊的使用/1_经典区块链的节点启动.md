> 本小节最后一次复现成功的时间：2023.02
#### 确认环境
```
Ubuntu：22.04.2 LTS
geth：1.11.5-stable
```
#### 在工作区目录下使用geth新建两个密码为123456的账户
```
> geth --datadir data1 account new
//0x1CE69B3512147Dbc5f1C1A931014Ee2e92d1DDeD
> geth --datadir data1 account new
//0xdf0fCfCAa6C816b09A8Ee22FEFe7C076650A7A51
```

参数说明：
- `--datadir`：指定用户密钥文件夹keystore/的存放路径。

观察可以发现：  
- 在工作区中出现了data1/及data1/keystore/两个文件夹，后者中有两个包含用户密钥的文件

注意事项：
- 学习用账户密码建议统一成`123456`方便记忆及测试

#### 在工作区中新建创世配置文件[genesis1.json](../../src/genesis_for_init_geth_node/genesis1.json)
```
{
    "config": {
        "chainId": 12345,
        "homesteadBlock": 0,
        "eip150Block": 0,
        "eip155Block": 0,
        "eip158Block": 0,
        "byzantiumBlock": 0,
        "constantinopleBlock": 0,
        "petersburgBlock": 0,
        "istanbulBlock": 0,
        "berlinBlock": 0,
        "ethash": {}
    },
    "difficulty": "1",
    "gasLimit": "8000000",
    "alloc字段的注释，geth在初始化时会忽略此字段": "将alloc中用户地址设置为刚刚生成的新用户的地址并分配一定的初始资金，初始资金单位是Wei",
    "alloc": {
        "0x1CE69B3512147Dbc5f1C1A931014Ee2e92d1DDeD": { "balance": "300000" },
        "0xdf0fCfCAa6C816b09A8Ee22FEFe7C076650A7A51": { "balance": "400000" }
    }
}
```

字段说明：
- `config.chainId`：区块链的链Id。一个区块链网络中可能存在用chainId区分的多条链，chainId可以避免一个交易在签名之后被受益者重复提交在不同链上即[重放攻击](https://zhuanlan.zhihu.com/p/467539681)。
- `config.homesteadBlock`：在第xxx区块启动以太坊家园版本。
- `config.eip150Block`、`config.eip155Block`、`config.eip158Block`：在第xxx区块启动新EIP150/155/158提案
- `config.ByzantiumBlock`：……
- `config.constantinopleBlock`：……
- `config.petersburgBlock`：……
- `config.istanbulBlock`：……
- `config.berlinBlock`：……
- `config.ethash`：标识当前私链使用ethash共识算法（PoW机制）
- `difficulty`：出块难度，私链测试先设置的小一些，随着挖矿的进行以太坊会动态调整该难度
- `gasLimit`：汽油费上限，限制区块能包含的交易及合约数量，这里设置的大一些
- `alloc`：为预设账号分配以太币，单位是wei（wei是很小的单位 1ether=1e18wei）

#### 使用创世配置文件进行创世
```
> geth --datadir data1 init genesis.json
```

参数说明：
- `--datadir`：设置节点存放区块链数据的位置

观察可以发现：  
- 工作区中出现了data1/geth/用于存放区块链数据

#### 启动私有链的第一个节点
```
> geth --identity "test_node1"  --networkid 11500 --datadir data1 --http --http.addr 127.0.0.1 --http.port 8545 --http.api eth,net,web3 --rpc.enabledeprecatedpersonal --http.corsdomain "*" --authrpc.addr 127.0.0.1 --authrpc.port 8551   --port 30303 --maxpeers 3  --nodiscover --allow-insecure-unlock --dev.period 1 --syncmode full --verbosity 6 console 2>> node1_output.log
```

参数说明：
- `--identity`：节点在区块链网络中的名称
- `--networkid`：设置网络ID，具有相同网络ID的节点才能进行通讯，此处随意选择，以11500为例。以太坊主网的ID为1,可以在[这里](https://chainlist.org/)查看当前公网中使用的网络ID列表
- `--datadir`：指定私链数据和密钥文件的存放路径
- `--http`：指定该节点接收使用HTTP-RPC协议的服务请求，较详细的以太坊的RPC协议实现的内容可以参考[这里](https://cloud.tencent.com/developer/article/1850880)
- `--http.addr`：HTTP-RPC服务器网络地址，设置为127.0.0.1表示只接受节点自己发出的请求
- `--http.port`：HTTP-RPC服务器监听端口，默认是8545
- `--http.api`：指定该节点的HTTP-RPC接口启用哪些API，我们可以使用geth的js控制台或其它本地or远程程序和该节点运行的区块链进行交互
- `--rpc.enabledeprecatedpersonal`：geth在1.11.0版本将personalAPI弃用，personal的大部分功能被迁移到了[Clef](https://geth.ethereum.org/docs/tools/clef/introduction)中。为了方便学习我们使用该参数开启节点对personalAPI的支持
- `--http.corsdomain`：接受跨域资源请求的域的域名的列表，本节点仅执行列表内域名请求的RPC客户端任务，域名用逗号分隔，默认是*。若要使用浏览器对服务器进行访问则需强制指定此参数
- `--authrpc.addr`：rpc认证服务器地址
- `--authrpc.port`：rpc认证服务监听端口，默认是8551
- `--port`：用于该节点监听及发现网络上其它节点的端口，以太坊的TCP监听和UDP发现共用一个端口，默认是30303
- `--maxpeers`：指定该节点所能连接的最大节点数量，默认是50。这里设置为2因为之后要测试包含三个节点的区块链网络，每个节点有两个peer
- `--nodiscover`：禁用对等发现机制，除非手动添加否则他人无法自动发现此节点，在此设置下节点的发现端口（UDP）被设置为0表示禁用
- `--allow-insecure-unlock`：允许在geth的命令窗口解锁账户
- `--dev.period`：在开发者模式下挖矿的周期，默认为0有待定交易时才进行挖矿，1则是在开发者模式下自动挖矿，更多信息请看[这里](https://blog.csdn.net/Mia0717/article/details/104945384)
- `--syncmode`：设置节点的同步模式，详见[这里](https://geth.ethereum.org/docs/fundamentals/sync-modes#full-sync)，此处选择full模式即同步全部区块头和区块体并重放所有交易
- `--verbosity`：输出日志的详细程度，这里设置成6可以看到更多细节便于学习和调试
- `console`：启动后进入Js交互环境，环境内可以通过geth提供的api进行区块链操作
- `2>> node1_output.log`：将输出重定向到node1_output.log中。该处是bash命令，2代表标准输出和标准错误，1代表仅标准输出，>代表改写，>>代表追加，可根据实际需要调整参数。

观察可以发现：
- 日志及控制台窗口输出了一些表示节点启动成功的信息

#### 注意事项
- 遇到问题不妨看一下日志，日志中包含问题的很多线索
- geth的更多参数请参考[官方文档](https://geth.ethereum.org/docs/fundamentals/command-line-options)，建议读者花几分钟大致浏览一遍